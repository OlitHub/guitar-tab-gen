% define document class and set class options
\documentclass[11pt, a4paper]{article}

%===============================================
% *** LIST OF GENERAL PACKAGES *** %
% language package (french option available as well)
\usepackage[english]{babel}

% input fonts
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{csquotes}

% customize default page geometry (size of margins, ...)
\usepackage{geometry}
\geometry{hmargin=2cm,vmargin=3cm}
\usepackage{titling}

\usepackage{titlesec}

% writing style
\usepackage{lmodern}
\usepackage{times}	 

% include images (image extensions & paths)
\usepackage{graphicx}
\DeclareGraphicsExtensions{.pdf,.jpg,.png,.eps}
\graphicspath{{figs/}}

\usepackage{wrapfig}

% display hyperlinks in the text
\usepackage{hyperref}  %
\hypersetup{colorlinks,%
            citecolor=red,%
            filecolor=black,%
            linkcolor=blue,%
            urlcolor=blue,%
            breaklinks=true}
            
% customize enumerated lists
\usepackage{enumitem}

% for \justify command
\usepackage{ragged2e}

% lipsum command to fill in the document (for visualisation purposes)
\usepackage{lipsum}

%===============================================
% *** CAPTIONS AND SUBFIGURES *** %
\usepackage{subcaption}

%===============================================
% *** TABLES *** %
\usepackage{booktabs}
\usepackage{multirow}

%=============================================== 
% *** BIBLIOGRAPHY (FOR BIBLATEX) *** %
\usepackage[
    backend=biber,
    style=ieee,
    ]{biblatex}

\usepackage{bookmark}
\addbibresource{bgtg_lib.bib}

% citation style: apa, ieee, authoryear, ...

%===============================================
% *** MATHS / PHYSICS PACKAGES *** %
\usepackage{amsfonts,amssymb,amsmath,amsthm}
\usepackage{mathrsfs}
\usepackage{mathtools}  % for DeclarePairedDelimiter
\usepackage{siunitx}    % notation physical units

% notations (shortcuts)
\newcommand{\bs}[1]{\boldsymbol{#1}}
\newcommand{\nbpix}{N}
\DeclareMathOperator{\prox}{prox}
\DeclareMathOperator{\sgn}{sgn}
\DeclareMathOperator*{\argmin}{argmin}
\DeclarePairedDelimiter{\norm}{\lVert}{\rVert}

%===============================================
% *** TITLE, AUTHOR AND DATE *** %
% \pretitle{\begin{center}\fontsize{30bp}{30bp}\selectfont}
% \posttitle{\par\end{center}}

% \preauthor{\begin{center}\fontsize{14bp}{14bp}\selectfont}
% \postauthor{\par\end{center}}
%===============================================
% *** MAIN DOCUMENT *** %
\begin{document}

\input{aux_tex/titlepage}

% \begin{figure}[t]% We use titling to put a figure on top of the title page
%     \centering
%     \includegraphics[width=.5\linewidth]{logos_empile}
% \end{figure}

% \title{Bass guitar tablature conditional generation for guitar accompaniment in western popular music}

% \author{Olivier \textsc{Anoufa} \\  University of Lille, France \\ Master 2 Data Science: Research project}

% {\let\newpage\relax\maketitle}

\newpage

\section{Introduction}

\input{aux_tex/introduction}

\section{State of the art}

\input{aux_tex/sota}

\section{Data preprocessing}
% What we have done (data preprocessing, getting the rhythmic instrument, retrieving the tokens, baseline using dadagp (GuitarCTRL))
% draw io fig of the model
As seen previously, DadaGP token files contain the tokens of all the instruments of the score.
However we want to try several combinations of conditioning instruments, so we first built a function that retrieves the tokens of a specific list of instruments.
Among the possible combinations, we especially wanted to condition the tablature generation on the rhythmic guitar.
The most common instrumentation of a rock band contains a lead guitar and a rhythmic guitar\cite{regnier_identification_2021}.
Rhythmic has a role that is close to the one of the bass, but at a higher pitch.
Generally, rhythmic guitar plays chords repetitively, giving both the harmonic and rhythmic information of the song.

% --> Retrieving, cleaning, mapping DadaGP
% Rhythmic guitar detection (cite paper)

The method of identification proposed by RÃ©gnier et al. \cite{regnier_identification_2021} is based on several features describing the notes and chords played at bar-level, and their corresponding tablatures.
We used their code to perform this identification on the DadaGP dataset.
A lot of time was spent on the mapping between the identified rhythmic guitar and its name in the DadaGP files as DadaGP renames the instrument whereas the identifier uses the part names in GuitarPro.

\section{Baseline predictions}
Now that we have the data, we can start training a model.
Before trying the model by Makris et al. we wanted to try a baseline model. We used a checkpoint of the model presented in the DadaGP paper \cite{sarmento_dadagp_2021} that we did not train ourselves.
To have a correct baseline of bass generation we tried several prompts. 
At first we gave the model a single note of bass guitar at the beginning of the tokens. 
However after a few tokens the model start adding other instruments' tokens.
We then tried setting the logits of the other instruments to $-\infty$ to force the model to only generate bass guitar tokens.
It works but as the model was not trained on this task, it generates a poor bass line, with a lot of repeated phrases and harmonically incorrect notes.
To have a better baseline, we will train a model only on bass guitar tokens.

\section{Workplan}
% Workplan (what we are going to do)

Better baseline with a model trained only on bass guitar tokens.
Then we will try the model by Makris et al. \cite{makris_guitarctrl_2021} on the same task.
Evaluate results with a human evaluation and a quantitative evaluation.


\newpage

%\nocite{*} % force display of the full content of the .bib file, w/o any citation in the document
\printbibliography% references: print bibliography (with bibtex file)

\end{document}